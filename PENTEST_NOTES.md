# Internal Penetration Testing Notes

## Targets
- Auth endpoints: /api/auth/register, /api/auth/login, /api/auth/mfa/verify
- Profile endpoints: /api/users/me
- Admin audit logs: /api/admin/audit-logs
- Payments: /api/payments/create-intent

## Proof-of-Concept (PoC) Checks

### 1) Brute-force protection
- Attempt 6 invalid logins within 15 minutes.
- Expected: 5 failures -> 6th returns 429.

### 2) Account lockout
- Attempt 5 invalid logins across different IPs.
- Expected: account locked (423) for 30 minutes.

### 3) CSRF protection
- POST to /api/auth/logout without X-CSRF-Token header.
- Expected: 403.

### 4) RBAC / IDOR
- Access /api/admin/audit-logs as non-admin.
- Expected: 403.
- Access /api/auth/users/:id for other users.
- Expected: 403.

### 5) MFA verification rate limit
- POST /api/auth/mfa/verify with invalid code 6 times.
- Expected: 429 after 5 attempts.

## Remediation Notes
- Ensure strong secrets and rotate periodically.
- Enforce HTTPS in production.
- Keep dependencies updated and re-run tests.

